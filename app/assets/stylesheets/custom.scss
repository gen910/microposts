
Lesson7
Twitterクローン

1. はじめに

メッセージボードのレッスンで簡単なWebアプリケーションの作成を行いましたが、このレッスンでは、より本格的なWebアプリケーションとして、Twitterクローンの作成を行います。

基本的な機能として、以下の実装を行います。

ユーザーが新規登録・ログインできる
つぶやき（マイクロポスト）を投稿できる
他のユーザーをフォローして、タイムラインを表示できる
このレッスンで説明する内容は、オリジナルのWebアプリケーションを作成したり、仕事でRailsを使ってプログラミングを行う上でよく使うテクニックを含んでいます。実際に手を動かしながら分からない点は調べたりメンターに質問したりして理解していきましょう。

完了済み
2. アプリケーションの新規作成

2.1 初期設定

Cloud9上のターミナルから以下を実行して、micropostsという名前でアプリケーションを新規作成します。
（今回は後からbundle installコマンドを実行するので、rails new micropostsに-Bオプションを指定することで、bundle installが自動で実行されないようにしています。）

$ rails new microposts -B
ファイルの生成が完了したらcd microposts/を実行してmicropostsフォルダに移動します。

ここまで出来たところで、Gitリポジトリの初期化を行います。

$ git init
$ git add .
$ git commit -m "first commit"
メッセージボードと同じ手順でGitHubにmicropostsというリポジトリを作成します。

GitHubの指示に従って、作成したリポジトリにアプリケーションをpushします。

$ git remote add origin git@github.com:[あなたのアカウント名]/microposts.git
$ git push origin master
2.2 ジェネレータの設定

今回は、テストコードとJavaScript、CSS(SCSS)、ヘルパのファイルを自動生成しないので、Rails側であらかじめ設定しておきます。

アプリケーションの設定ファイルの、class Application < Rails::Applicationの中に以下のように設定します。

config/application.rb

...
module Microposts
  class Application < Rails::Application
    ...

    config.generators do |g|
      g.stylesheets false
      g.javascripts false
      g.helper false
      g.test_framework false
    end
  end
end
完了済み
3. レイアウトのセットアップ

3.1 Bootstrapの追加

今回はBootstrapを使ってレイアウトを行いますので、Gemfileの25行目付近にgem 'bootstrap-sass'を追加します。
また、20行目付近のgem 'turbolinks'は今回は使用しないので、行頭に#を追加してコメントアウトしておきます。

Gemfile

...
# gem 'turbolinks'
# Build JSON APIs with ease. Read more: https://github.com/rails/jbuilder
gem 'jbuilder', '~> 2.0'
# bundle exec rake doc:rails generates the API under doc/api.
gem 'sdoc', '~> 0.4.0', group: :doc

gem 'bootstrap-sass'

# Use ActiveModel has_secure_password
# gem 'bcrypt', '~> 3.1.7'
...
上記の内容で保存したらbundle installを実行します。

3.2 カスタムSCSSの追加

Railsはコントローラを生成するごとにSCSSファイルを生成しますが、今回はBootstrapをベースにして1つのSCSSファイルでデザインを行うことにします。app/assets/stylesheets/内にcustom.scssファイルを以下の内容で作成します。（拡張子がscssとなっていることに注意してください。）

app/assets/stylesheets/custom.scss

@import "bootstrap-sprockets";
@import "bootstrap";

/* universal */

body {
  padding-top: 60px;
}

section {
  overflow: auto;
}

textarea {
  resize: vertical;
}

.center {
  text-align: center;
}

.center h1 {
  margin-bottom: 10px;
}

/* typography */

h1, h2, h3, h4, h5, h6 {
  line-height: 1;
}

h1 {
  font-size: 3em;
  letter-spacing: -2px;
  margin-bottom: 30px;
  text-align: center;
}

h2 {
  font-size: 1.2em;
  letter-spacing: -1px;
  margin-bottom: 30px;
  text-align: center;
  font-weight: normal;
  color: #777;
}

p {
  font-size: 1.1em;
  line-height: 1.7em;
}

/* header */

#logo {
  float: left;
  margin-right: 10px;
  font-size: 1.7em;
  color: #fff;
  text-transform: uppercase;
  letter-spacing: -1px;
  padding-top: 9px;
  font-weight: bold;
}

#logo:hover {
  color: #fff;
  text-decoration: none;
}